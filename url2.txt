from flask import Flask, request

app = Flask(__name__)

latest_data1 = None
latest_data2 = None

@app.route('/process', methods=['POST'])
def process1():
    global latest_data1
    data = request.form.get('data')
    if data:
        latest_data1 = data
        return "Data received and stored for process1"
    else:
        return "No data received"

@app.route('/process2', methods=['POST'])
def process2():
    global latest_data2
    data = request.form.get('data')
    if data:
        latest_data2 = data
        return "Data received and stored for process2"
    else:
        return "No data received"

def get_combined_data():
    global latest_data1, latest_data2
    new_latest_data1 = latest_data1[:-3] + '},' 
    new_lastest_data2 = latest_data2[1:]
    combined_data = new_latest_data1 + new_lastest_data2
    return combined_data

@app.route('/characters', methods=['GET'])


def get_characters():

    
    if latest_data2 and latest_data1:    
        combined_data = get_combined_data()
        return combined_data
    elif latest_data1:
        return latest_data1
    elif latest_data2:
        return latest_data2
    else:
        return "No data available yet.", 404

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=5000)

